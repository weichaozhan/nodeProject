(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-c03ffa54"],{"1cf5":function(e,t,i){"use strict";i.r(t);var o=i("efa4"),a=(i("84fb"),i("761c")),r=i("4eb6"),n={name:"",data:function(){return{form:{publishTime:"",title:"",imgUrl:"",topicType:1,tag:1},rules:{publishTime:[{required:!0,message:"请选择发布时间",trigger:"blur"}],title:[{required:!0,message:"请输入话题标题",trigger:"blur"}],imgUrl:[{required:!0,message:"请上传话题海报",trigger:"blur"}],topicType:[{required:!0,message:"请选择话题类型",trigger:"blur"}],tag:[{required:!0,message:"请选择投票标签",trigger:"blur"}]},imgUploadAPI:a.g,tabLabel:{0:"没有标签",1:"支持 vs 反对",2:"正确 vs 错误",3:"喜欢 vs 不喜欢"},loadingGlobal:!1,imgLoading:!1,loadingOption:!1,loadingDelete:!1}},props:{actionType:{required:"true"},topicId:{type:Number}},methods:{getTopicDetailInfo:function(){var e=this;this.loadingGlobal=!0,Object(r.f)({id:this.topicId}).then(function(t){var i=t.data.data;e.form={publishTime:i.publishTime,title:i.title,imgUrl:i.imgUrl,topicType:i.topicType,tag:i.tag},e.loadingGlobal=!1}).catch(function(t){e.loadingGlobal=!1})},handlePosterSuccess:function(e,t){this.imgLoading=!1,this.form.imgUrl=e.data.url},changeTopicType:function(e){this.form.tag=1===e?1:0},oprateTopic:function(){var e=this;this.$refs.form.validate(function(t){if(t){var i="edit"===e.actionType?r.g:r.a;e.loadingOption=!0,i(Object(o.a)({},e.form),e.topicId).then(function(t){var i=t.data;1e3===i.code?(e.$message({type:"success",message:"编辑成功！"}),e.$emit("refresh-list"),e.$emit("refresh-detail"),e.closeForm()):e.$message({type:"error",message:i.msg}),e.loadingOption=!1}).catch(function(t){e.loadingOption=!1})}})},deleteTopic:function(){var e=this;this.$confirm("是否要删除这个话题？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.loadingDelete=!0,Object(r.c)({id:e.topicId}).then(function(t){var i=t.data;1e3===i.code?(e.$message({type:"success",message:"删除成功！"}),e.$emit("refresh-list"),e.$emit("back-list"),e.closeForm()):e.$message({type:"error",message:i.msg}),e.loadingDelete=!1}).catch(function(t){e.loadingDelete=!1})}).catch(function(){})},closeForm:function(){this.$emit("close-form")}},mounted:function(){"edit"===this.actionType&&this.getTopicDetailInfo()}},l=(i("a17d"),i("048f")),s=Object(l.a)(n,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingGlobal,expression:"loadingGlobal"}]},[i("div",{staticClass:"option-title-wrapper"},[i("h3",{staticClass:"fl-l"},[e._v(e._s("edit"===e.actionType?"编辑":"新增")+"话题")]),i("div",{staticClass:"options fl-r"},["edit"===e.actionType?i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingDelete,expression:"loadingDelete"}],attrs:{size:"small",type:"danger"},on:{click:e.deleteTopic}},[e._v("删除")]):e._e(),i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingOption,expression:"loadingOption"}],attrs:{size:"small",type:"primary"},on:{click:e.oprateTopic}},[e._v("保存")]),i("el-button",{attrs:{size:"small"},on:{click:e.closeForm}},[e._v("返回")])],1)]),i("el-form",{ref:"form",staticClass:"content-edit",attrs:{model:e.form,rules:e.rules,"label-width":"100px","label-position":"left"}},["edit"===e.actionType?i("div",{staticClass:"msg--detail-topic"},[i("span",{staticClass:"title--content-item"},[e._v("话题ID")]),e._v(e._s(e.topicId)+"                \n        ")]):e._e(),i("el-form-item",{attrs:{prop:"publishTime",label:"发布时间"}},[i("el-date-picker",{attrs:{clearable:!1,type:"datetime",placeholder:"选择发布时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.form.publishTime,callback:function(t){e.$set(e.form,"publishTime",t)},expression:"form.publishTime"}})],1),i("el-form-item",{attrs:{prop:"title",label:"话题标题"}},[i("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"话题海报",prop:"imgUrl"}},[i("p",{staticStyle:{color:"skyblue"}},[e._v("请上传图片比例为31：13的图片")]),i("div",{staticClass:"poster-wrapper"},[i("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.imgLoading,expression:"imgLoading"}],staticClass:"poster-uploader",attrs:{action:e.imgUploadAPI,"show-file-list":!1,"on-success":e.handlePosterSuccess,"before-upload":function(){e.imgLoading=!0},"on-error":function(){e.imgLoading=!1},accept:"image/jpg,image/jpeg,image/png"}},[e.form.imgUrl?i("img",{staticClass:"poster",attrs:{src:e.form.imgUrl}}):i("i",{staticClass:"el-icon-plus poster-uploader-icon"})])],1)]),i("el-form-item",{attrs:{prop:"topicType",label:"话题类型"}},[i("el-radio-group",{on:{change:e.changeTopicType},model:{value:e.form.topicType,callback:function(t){e.$set(e.form,"topicType",t)},expression:"form.topicType"}},[i("el-radio",{attrs:{label:1}},[e._v("投票话题")]),i("el-radio",{attrs:{label:2}},[e._v("普通话题")])],1)],1),1===e.form.topicType?i("el-form-item",{attrs:{prop:"tag",label:"投票标签"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.tag,callback:function(t){e.$set(e.form,"tag",t)},expression:"form.tag"}},[i("el-option",{attrs:{label:"支持/反对",value:1}}),i("el-option",{attrs:{label:"正确/错误",value:2}}),i("el-option",{attrs:{label:"喜欢/不喜欢",value:3}})],1),i("p",[e._v("当前投票标签为："),i("span",{staticStyle:{color:"gray"}},[e._v(e._s(e.tabLabel[e.form.tag]))])])],1):e._e()],1)],1)},[],!1,null,"d432dcfc",null);s.options.__file="ActionTopic.vue";t.default=s.exports},"438f":function(e,t,i){},"761c":function(e,t,i){"use strict";i.d(t,"g",function(){return r}),i.d(t,"j",function(){return n}),i.d(t,"e",function(){return l}),i.d(t,"b",function(){return s}),i.d(t,"h",function(){return c}),i.d(t,"a",function(){return u}),i.d(t,"i",function(){return p}),i.d(t,"c",function(){return d}),i.d(t,"f",function(){return m}),i.d(t,"d",function(){return g});var o=i("5bf4"),a=i("4088"),r="".concat(a.a,"/upload"),n=function(e){return Object(o.a)({url:"/upload",method:"post",data:e})},l=function(){return Object(o.a)({url:"/getProvince",method:"get"})},s=function(e){return Object(o.a)({url:"/getCityList",method:"get",params:e})},c=function(e){return Object(o.a)({url:"/users/login",method:"post",data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},u=function(){return Object(o.a)({url:"/account/authList",method:"get"})},p=function(e){return Object(o.a)({url:"/users/modifyPassword",method:"post",data:e})},d=function(e){return Object(o.a)({url:"/member/doctor/getHospitalList",method:"get",params:e})},m=function(e){return Object(o.a)({url:"/content/secondDepartment",method:"get",params:e})},g=function(){return Object(o.a)({url:"/member/doctor/getPositionalTitleList",method:"get"})}},a17d:function(e,t,i){"use strict";var o=i("438f");i.n(o).a}}]);